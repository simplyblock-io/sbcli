# syntax=docker/dockerfile:1
FROM python:3.9-slim

RUN apt-get update; apt-get install -y \
    wget libc6 inetutils-ping dmidecode nvme-cli open-iscsi iptables \
    iproute2 pciutils sudo nano parted gdisk ssh ;

ARG TARGETPLATFORM
RUN if [ "$TARGETPLATFORM" = "linux/arm64" ]; then \
        echo "ARM64 version"; \
    else \
        echo "AMD64 version"; \
        wget https://github.com/apple/foundationdb/releases/download/7.3.56/foundationdb-clients_7.3.56-1_amd64.deb; \
        dpkg -i foundationdb-clients_7* ; \
        rm -f foundationdb-clients_7* ; \
    fi

WORKDIR /app

# pip install
COPY requirements.txt requirements.txt
COPY simplyblock_web/requirements.txt simplyblock_web/requirements.txt

RUN pip3 install -r requirements.txt
RUN pip3 install -r simplyblock_web/requirements.txt
